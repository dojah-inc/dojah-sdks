"use strict";var V=Object.defineProperty;var Oe=Object.getOwnPropertyDescriptor;var be=Object.getOwnPropertyNames;var ve=Object.prototype.hasOwnProperty;var I=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ae=(e,t)=>{for(var r in t)V(e,r,{get:t[r],enumerable:!0})},Pe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of be(t))!ve.call(e,i)&&i!==r&&V(e,i,{get:()=>t[i],enumerable:!(n=Oe(t,i))||n.enumerable});return e};var je=e=>Pe(V({},"__esModule",{value:!0}),e);var z=I((Te,W)=>{"use strict";var x,o,H={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:`
`,r:"\r",t:"	"},k;function v(e){throw{name:"SyntaxError",message:e,at:x,text:k}}function a(e){return e&&e!==o&&v("Expected '"+e+"' instead of '"+o+"'"),o=k.charAt(x),x+=1,o}function K(){var e,t="";for(o==="-"&&(t="-",a("-"));o>="0"&&o<="9";)t+=o,a();if(o===".")for(t+=".";a()&&o>="0"&&o<="9";)t+=o;if(o==="e"||o==="E")for(t+=o,a(),(o==="-"||o==="+")&&(t+=o,a());o>="0"&&o<="9";)t+=o,a();return e=Number(t),isFinite(e)||v("Bad number"),e}function L(){var e,t,r="",n;if(o==='"')for(;a();){if(o==='"')return a(),r;if(o==="\\")if(a(),o==="u"){for(n=0,t=0;t<4&&(e=parseInt(a(),16),!!isFinite(e));t+=1)n=n*16+e;r+=String.fromCharCode(n)}else if(typeof H[o]=="string")r+=H[o];else break;else r+=o}v("Bad string")}function O(){for(;o&&o<=" ";)a()}function Se(){switch(o){case"t":return a("t"),a("r"),a("u"),a("e"),!0;case"f":return a("f"),a("a"),a("l"),a("s"),a("e"),!1;case"n":return a("n"),a("u"),a("l"),a("l"),null;default:v("Unexpected '"+o+"'")}}function Ie(){var e=[];if(o==="["){if(a("["),O(),o==="]")return a("]"),e;for(;o;){if(e.push(w()),O(),o==="]")return a("]"),e;a(","),O()}}v("Bad array")}function xe(){var e,t={};if(o==="{"){if(a("{"),O(),o==="}")return a("}"),t;for(;o;){if(e=L(),O(),a(":"),Object.prototype.hasOwnProperty.call(t,e)&&v('Duplicate key "'+e+'"'),t[e]=w(),O(),o==="}")return a("}"),t;a(","),O()}}v("Bad object")}function w(){switch(O(),o){case"{":return xe();case"[":return Ie();case'"':return L();case"-":return K();default:return o>="0"&&o<="9"?K():Se()}}W.exports=function(e,t){var r;return k=e,x=0,o=" ",r=w(),O(),o&&v("Syntax error"),typeof t=="function"?function n(i,f){var p,u,s=i[f];if(s&&typeof s=="object")for(p in w)Object.prototype.hasOwnProperty.call(s,p)&&(u=n(s,p),typeof u>"u"?delete s[p]:s[p]=u);return t.call(i,f,s)}({"":r},""):r}});var Y=I((Ue,G)=>{"use strict";var F=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,m,R,we={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},P;function $(e){return F.lastIndex=0,F.test(e)?'"'+e.replace(F,function(t){var r=we[t];return typeof r=="string"?r:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function E(e,t){var r,n,i,f,p=m,u,s=t[e];switch(s&&typeof s=="object"&&typeof s.toJSON=="function"&&(s=s.toJSON(e)),typeof P=="function"&&(s=P.call(t,e,s)),typeof s){case"string":return $(s);case"number":return isFinite(s)?String(s):"null";case"boolean":case"null":return String(s);case"object":if(!s)return"null";if(m+=R,u=[],Object.prototype.toString.apply(s)==="[object Array]"){for(f=s.length,r=0;r<f;r+=1)u[r]=E(r,s)||"null";return i=u.length===0?"[]":m?`[
`+m+u.join(`,
`+m)+`
`+p+"]":"["+u.join(",")+"]",m=p,i}if(P&&typeof P=="object")for(f=P.length,r=0;r<f;r+=1)n=P[r],typeof n=="string"&&(i=E(n,s),i&&u.push($(n)+(m?": ":":")+i));else for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i=E(n,s),i&&u.push($(n)+(m?": ":":")+i));return i=u.length===0?"{}":m?`{
`+m+u.join(`,
`+m)+`
`+p+"}":"{"+u.join(",")+"}",m=p,i;default:}}G.exports=function(e,t,r){var n;if(m="",R="",typeof r=="number")for(n=0;n<r;n+=1)R+=" ";else typeof r=="string"&&(R=r);if(P=t,t&&typeof t!="function"&&(typeof t!="object"||typeof t.length!="number"))throw new Error("JSON.stringify");return E("",{"":e})}});var Q=I(q=>{"use strict";q.parse=z();q.stringify=Y()});var Z=I((He,X)=>{"use strict";var _=typeof JSON<"u"?JSON:Q(),Re=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"},Ee=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},r=[];for(var n in e)t.call(e,n)&&r.push(n);return r};X.exports=function(e,t){t||(t={}),typeof t=="function"&&(t={cmp:t});var r=t.space||"";typeof r=="number"&&(r=Array(r+1).join(" "));var n=typeof t.cycles=="boolean"?t.cycles:!1,i=t.replacer||function(u,s){return s},f=t.cmp&&function(u){return function(s){return function(l,c){var g={key:l,value:s[l]},d={key:c,value:s[c]};return u(g,d)}}}(t.cmp),p=[];return function u(s,l,c,g){var d=r?`
`+new Array(g+1).join(r):"",A=r?": ":":";if(c&&c.toJSON&&typeof c.toJSON=="function"&&(c=c.toJSON()),c=i.call(s,l,c),c!==void 0){if(typeof c!="object"||c===null)return _.stringify(c);if(Re(c)){for(var S=[],b=0;b<c.length;b++){var ye=u(c,b,c[b],g+1)||_.stringify(null);S.push(d+r+ye)}return"["+S.join(",")+d+"]"}if(p.indexOf(c)!==-1){if(n)return _.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}else p.push(c);for(var C=Ee(c).sort(f&&f(c)),S=[],b=0;b<C.length;b++){var l=C[b],J=u(c,l,c[l],g+1);if(!!J){var ge=_.stringify(l)+A+J;S.push(d+r+ge)}}return p.splice(p.indexOf(c),1),"{"+S.join(",")+d+"}"}}({"":e},"",e,0)}});var Be={};Ae(Be,{default:()=>qe});module.exports=je(Be);var y=require("@stoplight/spectral-functions"),j=require("@stoplight/spectral-formats"),de=require("@stoplight/spectral-rulesets");var M;(function(e){e.Simple="simple",e.Matrix="matrix",e.Label="label",e.Form="form",e.CommaDelimited="commaDelimited",e.SpaceDelimited="spaceDelimited",e.PipeDelimited="pipeDelimited",e.DeepObject="deepObject"})(M||(M={}));var h;(function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Information=2]="Information",e[e.Hint=3]="Hint"})(h||(h={}));var T;(function(e){e.Article="article",e.HttpService="http_service",e.HttpServer="http_server",e.HttpOperation="http_operation",e.Model="model",e.Generic="generic",e.Unknown="unknown",e.TableOfContents="table_of_contents",e.SpectralRuleset="spectral_ruleset",e.Styleguide="styleguide",e.Image="image"})(T||(T={}));var U;(function(e){e.Json="json",e.Markdown="markdown",e.Yaml="yaml",e.Javascript="javascript",e.Apng="apng",e.Avif="avif",e.Bmp="bmp",e.Gif="gif",e.Jpeg="jpeg",e.Png="png",e.Svg="svg",e.Webp="webp"})(U||(U={}));var N=e=>e.length<=1?[]:[{message:"Potential misuse of security has been detected"}];var te=require("@stoplight/json-ref-resolver"),ee=Z(),_e=new te.Resolver,D=async({refOrObject:e,source:t})=>"$ref"in e?(await _e.resolve(t,{jsonPointer:e.$ref})).result:e,re=({a:e,b:t,comparator:r})=>e.filter(n=>t.filter(i=>r(n,i)).length>0).length>0;var ne=(e,t)=>{if(e.length!==t.length)return!1;let r=e.map(i=>ee(i)),n=t.map(i=>ee(i));return r.filter(i=>n.includes(i)).length===r.length},ie=(e,t)=>{e!==null&&oe(e,t,[])},oe=(e,t,r)=>{e!==null&&Object.entries(e).forEach(([n,i])=>{let f=[...r];f.push(n),t(n,i,f),typeof i=="object"?oe(i,t,f):t(n,i,f)})};var se=(e,t,r)=>{let n=[],i=r.document.data;return!i.security||!e.security?[]:(ne(i.security,e.security)&&n.push({message:"Detected redundant security schemes."}),n)};var ae=({rule:e,spec:t})=>{let r=t.info;if("x-konfig-ignore"in r){let n=r["x-konfig-ignore"];if(!Array.isArray(n))throw Error("x-konfig-ignore should be list of rule names");return n.includes(e)}return!1};var B="no-additional-properties",ce=(e,t,r)=>{let n=[],i=r.document.data;if(ae({rule:B,spec:i}))return;let f=0,p=0;return ie(i,(u,s,l)=>{typeof s=="object"&&s!==null&&"type"in s&&s.type==="object"&&(l.includes("responses")||l.includes("schemas"))&&(f++,p+=s.additionalProperties?1:0)}),f>0&&p===0&&n.push({message:"Detected potential problem with object types"}),n},ue=`No 'additionalProperties: true' detected on response
bodies throughout spec. Is your spec is 100% compliant with your production API?
If yes, ignore this rule in .spectral.yaml and move on. If no, ignore this rule
in .spectral.yaml by adding "x-konfig-ignore: 'no-additional-properties'" to
top-level OpenAPI Info object and configure your konfig.yaml to intelligently
attach 'additionalProperties: true' to response bodies.`;var fe=e=>{let t=[];if(typeof e!="object"||e===null||!("type"in e)||!("example"in e))return[];let r=e.type;if(typeof r!="string")return[];let n=e.example;return t.push(...De(r,n)),t},De=(e,t)=>e==="string"&&typeof t=="string"?Ve(t):[];function Ve(e){return Fe(e)?[{message:"Could be integer type based on example"}]:$e(e)?[{message:"Could be number type based on example"}]:ke(e)?[{message:"Could be boolean type based on example"}]:[]}function ke(e){return e==="true"||e==="false"}function Fe(e){return/^[-+]?\d+$/.test(e)}function $e(e){var t=/^-?\d+(?:[.,]\d*?)?$/;if(!t.test(e))return!1;let r=parseFloat(e);return!isNaN(r)}var pe=async({operation:e,document:t})=>{let r=e.parameters?.map(async n=>D({refOrObject:n,source:t}));if(r!==void 0)return await Promise.all(r)};var le=({security:e})=>{if(e.type==="oauth2"||e.type==="basic"||e.type==="http")return"Authorization";if(e.type==="apiKey")return e.name;throw Error("Not Implemented")};var me=async({document:e})=>{if("securityDefinitions"in e)return e.securityDefinitions;if("components"in e){let t=e.components?.securitySchemes;if(t===void 0)return;let r=await Promise.all(Object.entries(t).map(async([n,i])=>[n,await D({refOrObject:i,source:e})]));return Object.fromEntries(r)}};var he=async(e,t,r)=>{let n=[],i=r.document.data,f=i.security??e.security;if(f===void 0)return[];let p=await me({document:i});if(p===void 0)return[];let u=await pe({operation:e,document:i});if(u===void 0)return;let s=f.flatMap(g=>Object.keys(g).map(d=>{let A=p[d];if(A===void 0)throw Error(`Found security requirement ${d} referring to non-existent security scheme`);return A})),l;if(re({a:u,b:s,comparator:(g,d)=>{let A=g.name===le({security:d});return A&&(l=g.name),A}})){if(l===void 0)throw Error("Name should have been assigned when redundancy was detected.");n.push({message:l})}return n};var qe={extends:de.oas,aliases:{PathItem:["$.paths[*]"],OperationObject:["#PathItem[get,put,post,delete,options,head,patch,trace]"],ParameterSchemaObject:["#OperationObject.parameters.*.schema"],RequestSchemaObject:["#OperationObject.requestBody.content.*.schema"],ResponseSchemaObject:["#OperationObject.responses.*.content.*.schema"]},rules:{"operation-description":"off","operation-success-response":"off","info-contact":"off","no-http-basic":{description:"Consider a more secure alternative to HTTP Basic",message:"HTTP Basic is a pretty insecure way to pass credentials around, please consider an alternative.",given:"$.components.securitySchemes[*]",then:{field:"scheme",function:y.pattern,functionOptions:{notMatch:"basic"}},severity:h.Error},"no-file-extensions-in-paths":{description:"Paths must not include file extensions such as .json, .xml, .html and .txt",message:"Paths must not include file extensions such as .json, .xml, .html and .txt. Use the OpenAPI `content` keyword to tell consumers which Media Types are available.",given:"$.paths[*]~",then:{function:y.pattern,functionOptions:{notMatch:".(json|xml|html|txt)$"}},severity:h.Error},"adv-security-schemes-defined":{description:"All APIs MUST have a security scheme defined.",message:"This API definition does not have any security scheme defined.",given:"$..components",then:{field:"securitySchemes",function:y.truthy},formats:[j.oas3],severity:h.Error},"adv-security-schemes-defined-oas2":{description:"All APIs MUST have a security scheme defined.",message:"This API definition does not have any security scheme defined.",given:"$",then:{field:"securityDefinitions",function:y.schema,functionOptions:{schema:{type:"object",minProperties:1}}},formats:[j.oas2],severity:h.Error},"list-usage-of-security":{description:"List usage of security implies multiple possible security strategies which is uncommon",message:"Potential misuse of the security field. Only use list when you have multiple security strategies. (i.e. list vs map is significant https://swagger.io/docs/specification/authentication/)",given:["$.security","$.paths..security"],then:{function:N},formats:[j.oas3]},"operation-operationId":{message:"Assign Operation#operationId to create better SDK method names.",given:"#OperationObject",then:{field:"operationId",function:y.truthy}},"redundant-security-schemes":{message:"Remove redundant security schemes from operation object.",given:"#OperationObject",then:{function:se}},"redundant-security-and-parameter":{description:"Duplicate security and request parameters will cause generated SDKs to have undesired behavior.",message:'Detected security requirement and parameter with the same name "{{error}}".',given:"#OperationObject",then:{function:he},formats:[j.oas2,j.oas3],severity:h.Error},[B]:{message:ue,given:"#ResponseSchemaObject",then:{function:ce},severity:h.Error},"potential-data-type":{message:"{{error}}. Ensure your types are correct.",given:["#ResponseSchemaObject..","#RequestSchemaObject..","#ParameterSchemaObject.."],then:{function:fe},severity:h.Error},"limited-oas3_1-support":{message:"Konfig has limited support for OAS 3.1",given:"$.openapi",then:{function:y.pattern,functionOptions:{notMatch:"^3.1.\\d$"}},severity:h.Error},"multiple-tags":{message:"Having more than 1 tag can be confusing as generated SDKs will only show up under one tag.",given:"#OperationObject.tags",then:{function:y.length,functionOptions:{min:1,max:1}},severity:h.Warning}}};0&&(module.exports={});
module.exports = module.exports.default;
//# sourceMappingURL=ruleset.js.map